## 📝 [MSA] CircuitBreaker와 Resilience4j

- 서킷 브레이커
  - 서킷 브레이커는 마이크로서비스 간의 호출 실패를 감지하고 시스템의 전체적인 안정성을 유지하는 패턴이다. 외부 서비스 호출 실패 시 빠른 실패를 통해 장애를 격리하고, 시스템의 다른 부분에 영향을 주지 않도록 한다.   
- Resilience4J
  - Resilience4j는 서킷 브레이커 라이브러리로, 서비스 간의 호출 실패를 감지하고 시스템의 안정성을 유지해 준다. 다양한 서킷 브레이커 기능을 제공하며, 장애 격리 및 빠른 실패를 통해 복원력을 높여준다.
<hr>

### Resilience4j 주요 특징 
서킷 브레이커의 주요 상태 3가지

- 클로즈드(Closed)
  - 기본 상태로, 모든 요청을 통과시킵니다.
  - 이 상태에서 호출이 실패하면 실패 카운터가 증가합니다.
  - 실패율이 설정된 임계값(예: 50%)을 초과하면 서킷 브레이커가 오픈 상태로 전환됩니다.
  - ex) 최근 5번의 호출 중 3번이 실패하여 실패율이 60%에 도달하면 오픈 상태로 전환됩니다.
    
- 오픈(Open)
  -  서킷 브레이커가 오픈 상태로 전환되면 모든 요청을 즉시 실패로 처리합니다.
  -  이 상태에서 요청이 실패하지 않고 바로 에러 응답을 반환합니다.
  -  설정된 대기 시간이 지난 후, 서킷 브레이커는 하프-오픈 상태로 전환됩니다.
  -  ex) 서킷 브레이커가 오픈 상태로 전환되고 20초 동안 모든 요청이 차단됩니다.

- 하프-오픈(Half-Open)
  - 오픈 상태에서 대기 시간이 지나면 서킷 브레이커는 하프-오픈 상태로 전환됩니다.
  - 하프-오픈 상태에서는 제한된 수의 요청을 허용하여 시스템이 정상 상태로 복구되었는지 확인합니다.
  - 요청이 성공하면 서킷 브레이커는 클로즈드 상태로 전환됩니다.
  - 요청이 다시 실패하면 서킷 브레이커는 다시 오픈 상태로 전환됩니다.
  - ex) 하프-오픈 상태에서 3개의 요청을 허용하고, 모두 성공하면 클로즈드 상태로 전환됩니다. 만약 하나라도 실패하면 다시 오픈 상태로 전환됩니다. 

- Fallback
  - 호출 실패 시 대체 로직을 제공하여 시스템 안정성 확보 
  
Blog: https://happy-coding.tistory.com/11
